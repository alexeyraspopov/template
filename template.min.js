function Binding(a,b,c,d){this.type=a,this.scope=c,this.element=b,this.handler=d,observe(c,b.dataset[a],function(a){d.routine(b,a,c)})}function observe(a,b,c){a=targetByPath(a,b),Object.observe(a.object,function(b){b.filter(function(b){return b.name===a.key}).forEach(function(a){c(a.object[a.name])})}),c(a.object[a.key])}function write(a,b,c){a=targetByPath(a,b),a.object[a.key]=c}function tokenize(a){var b=a.split(".");return{list:b,name:b.pop()||a}}function targetByPath(a,b){var c=tokenize(b);return a=c.list.reduce(function(a,b){return a[b]},a),{object:a,key:c.name}}function View(a,b){this.element=a,this.scope=b,this.bindings=[],this.compile(),this.bind()}Binding.prototype.bind=function(){this.handler.publish&&this.handler.bind(this.element,this.publish.bind(this))},Binding.prototype.publish=function(){write(scope,this.element.dataset[this.type],this.handler.value(this.element))},text={routine:function(a,b){a.textContent=b}},model={publish:!0,bind:function(a,b){a.addEventListener("change",b)},value:function(a){return a.value},routine:function(a,b){a.value=b}},show={routine:function(a,b){a.style.visibility=b?"visible":"hidden"}},hide={routine:function(a,b){show.routine(a,!b)}},checked={publish:!0,bind:model.bind,value:function(a){return a.checked},routine:function(a,b){a.checked=!!b}},View.prototype.compile=function(){var a={acceptNode:function(){return NodeFilter.FILTER_ACCEPT}},b=document.createTreeWalker(this.element,NodeFilter.SHOW_ELEMENT,a,!1),c=b.currentNode;do this.createBindings(c),c=b.nextNode();while(c)},View.prototype.createBindings=function(a){Object.keys(a.dataset).filter(function(a){return!!window[a]}).forEach(function(b){this.bindings.push(new Binding(b,a,this.scope,this.handler(b)))},this)},View.prototype.handler=function(a){return window[a]},View.prototype.bind=function(){this.bindings.forEach(function(a){a.bind()})};